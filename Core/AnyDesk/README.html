<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
README
</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", "微軟正黑體", Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; border-bottom: 2px solid #95a5a6; padding-bottom: 8px; margin-top: 30px; }
        h3 { color: #7f8c8d; margin-top: 20px; }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Courier New", monospace;
        }
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        pre code {
            background-color: transparent;
            color: #ecf0f1;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        blockquote {
            border-left: 4px solid #3498db;
            padding-left: 20px;
            margin: 20px 0;
            color: #7f8c8d;
            background-color: #f8f9fa;
            padding: 10px 20px;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
<p>﻿# AnyDesk 安全模塊 (I1)</p>

<p>此目錄包含 SafeModeDefender 的 AnyDesk 安全檢測、清理和預防相關的所有腳本。</p>

<h2>檔案結構</h2>

<ul>
<li><code>I1_AnyDesk_Security.ps1</code>: 主檢測模塊，整合所有子檢測功能。</li>
<li><code>Advanced_Attack_Detection.ps1</code>: 進階攻擊檢測函數庫，包含 GPU 攻擊、GPO 篡改等檢測邏輯。</li>
<li><code>Emergency_Cleanup.ps1</code>: 緊急清理腳本，用於在系統被入侵後執行完整的清理和修復。</li>
<li><code>System_Hardening.ps1</code>: 系統強化腳本，用於預防未來的攻擊。</li>
</ul>

<h2>功能</h2>

<h3>1. 深度檢測</h3>

<ul>
<li><strong>GPU 渲染攻擊</strong>：檢測 Direct3D 錯誤、顯卡驅動程式衝突和異常的 GPU 使用率。</li>
<li><strong>GPO 篡改</strong>：檢測註冊表中的封鎖策略，識別被禁用的系統管理工具。</li>
<li><strong>ClickFix 社交工程</strong>：分析 PowerShell 歷史記錄、防火牆規則和 <code>mshta.exe</code> 執行記錄。</li>
<li><strong>隱私模式濫用</strong>：檢查配置檔案和日誌，發現攻擊者隱藏操作的跡象。</li>
<li><strong>已知漏洞</strong>：檢測 CVE-2024-52940 和 CVE-2024-12754 的攻擊指標。</li>
<li><strong>憑證冒用</strong>：分析 <code>service.conf</code> 和 <code>user.conf</code>，檢測身份冒用風險。</li>
</ul>

<h3>2. 緊急清理</h3>

<ul>
<li><strong>GPO 封鎖突破</strong>：提供離線修復指南，刪除被污染的原則檔案。</li>
<li><strong>AnyDesk 根除</strong>：徹底移除 AnyDesk 進程、服務、配置檔案和註冊表項。</li>
<li><strong>鑑識證據備份</strong>：在清理前自動備份所有相關日誌和配置檔案。</li>
</ul>

<h3>3. 系統強化</h3>

<ul>
<li><strong>防火牆強化</strong>：封鎖 AnyDesk 常用端口和已知的惡意 IP 範圍。</li>
<li><strong>AppLocker 策略</strong>：阻止 <code>anydesk.exe</code> 和 <code>mshta.exe</code> 的執行。</li>
<li><strong>審計策略</strong>：啟用進程創建、登入/登出和 PowerShell 腳本塊日誌記錄。</li>
<li><strong>Windows Defender 進階保護</strong>：啟用 ASR 規則、PUA 保護和受控資料夾存取。</li>
</ul>

<h2>使用方法</h2>

<h3>執行完整檢測</h3>

<p><code>powershell
.\SafeModeDefender.bat --cli --module I1_AnyDesk_Security
</code></p>

<h3>執行緊急清理</h3>

<p><strong>警告：</strong> 此腳本會對系統進行重大變更，請在了解風險後執行。</p>

<p>```powershell</p>

<h1>進入 Core\AnyDesk 目錄</h1>

<p>cd Core\AnyDesk</p>

<h1>執行清理腳本</h1>

<p>.\Emergency_Cleanup.ps1
```</p>

<h3>應用系統強化</h3>

<p>```powershell</p>

<h1>進入 Core\AnyDesk 目錄</h1>

<p>cd Core\AnyDesk</p>

<h1>應用所有強化措施</h1>

<p>.\System_Hardening.ps1 -ApplyAll
```</p>

<h2>依賴</h2>

<ul>
<li>Windows 10 或更高版本</li>
<li>PowerShell 5.1 或更高版本</li>
<li>管理員權限</li>
</ul>

<h2>注意事項</h2>

<ul>
<li>在執行任何清理或強化操作之前，請務必備份重要資料。</li>
<li><code>Emergency_Cleanup.ps1</code> 腳本執行後，強烈建議重新安裝作業系統以確保完全清除攻擊者的持久化機制。</li>
<li><code>System_Hardening.ps1</code> 腳本中的某些強化措施（如 AppLocker）僅在 Windows Enterprise/Education 版本中可用。</li>
</ul>
    </div>
</body>
</html>
